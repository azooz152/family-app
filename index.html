// --- وظيفة إرسال الرابط إلى App Inventor ---
function showPlayerOptions(id, ext, name) {
    let url = "";
    // بناء الرابط بناءً على القسم (مباشر، أفلام، مسلسلات)
    if(state.type === 'live') {
        url = `${CONFIG.host}/live/${CONFIG.user}/${CONFIG.pass}/${id}.${ext}`;
    } else if(state.type === 'movie') {
        url = `${CONFIG.host}/movie/${CONFIG.user}/${CONFIG.pass}/${id}.${ext}`;
    } else {
        url = `${CONFIG.host}/series/${CONFIG.user}/${CONFIG.pass}/${id}.${ext}`;
    }

    // إرسال الرابط فوراً إلى تطبيق App Inventor
    if (window.AppInventor) {
        window.AppInventor.setWebViewString(url);
    } else {
        // إذا كنت تجربه في المتصفح العادي سيظهر الرابط في تنبيه
        console.log("الرابط المجهز: " + url);
        alert("اضغط على القناة من داخل التطبيق لتشغيل المشغل");
    }
}
