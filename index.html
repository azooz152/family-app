<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AZOOZ TV - HULK STYLE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { --hilal-blue: #0057b7; --dark-bg: rgba(0, 0, 0, 0.85); }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Tahoma', sans-serif; }
        
        body {
            background-image: url('https://raw.githubusercontent.com/azooz152/family-app/main/home.png');
            background-size: cover; background-position: center; background-attachment: fixed;
            background-color: #000; color: white; overflow: hidden; height: 100vh;
        }

        /* --- الشاشة الرئيسية (3 أيقونات) --- */
        #home-screen {
            display: flex; justify-content: center; align-items: center;
            height: 100vh; gap: 40px; background: rgba(0, 0, 0, 0.4);
        }

        .main-btn {
            width: 220px; height: 280px; background: var(--dark-bg);
            border: 3px solid #333; border-radius: 25px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: 0.3s; cursor: pointer; text-decoration: none; color: white;
        }

        .main-btn i { font-size: 80px; margin-bottom: 20px; color: var(--hilal-blue); }
        .main-btn span { font-size: 24px; font-weight: bold; }

        .main-btn:focus, .main-btn:hover {
            transform: scale(1.1); border-color: var(--hilal-blue);
            box-shadow: 0 0 40px var(--hilal-blue); outline: none; background: #fff; color: var(--hilal-blue);
        }

        /* --- واجهة القوائم (نظام الهُولك) --- */
        #list-screen { display: none; height: 100vh; grid-template-columns: 300px 1fr; }

        .sidebar {
            background: var(--dark-bg); border-left: 2px solid var(--hilal-blue);
            overflow-y: auto; padding: 10px;
        }

        .category-item {
            padding: 15px; margin-bottom: 8px; background: #111;
            border-radius: 10px; cursor: pointer; transition: 0.2s;
            font-size: 18px; border-right: 5px solid transparent;
        }

        .category-item:focus, .category-item:hover {
            background: var(--hilal-blue); border-right-color: white; outline: none;
        }

        .content-area { padding: 20px; overflow-y: auto; display: grid; gap: 15px; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); }

        /* --- بوسترات الأفلام (هولك ستايل) --- */
        .poster-card {
            background: #111; border-radius: 12px; overflow: hidden;
            border: 2px solid #222; transition: 0.3s; cursor: pointer; position: relative;
        }

        .poster-card img { width: 100%; height: 230px; object-fit: cover; }

        .poster-card .title {
            padding: 8px; font-size: 13px; text-align: center;
            background: linear-gradient(transparent, black);
            position: absolute; bottom: 0; width: 100%;
        }

        .poster-card:focus {
            transform: scale(1.1); border-color: var(--hilal-blue);
            box-shadow: 0 0 20px var(--hilal-blue); outline: none; z-index: 10;
        }

        /* شاشة التحميل */
        #loader {
            position: fixed; top:0; left:0; width:100%; height:100%; background: #000;
            display: none; justify-content: center; align-items: center; z-index: 100;
        }
    </style>
</head>
<body>

    <div id="loader"><i class="fas fa-circle-notch fa-spin fa-4x" style="color:var(--hilal-blue)"></i></div>

    <div id="home-screen">
        <div class="main-btn" tabindex="1" onclick="loadCategories('live')">
            <i class="fas fa-tv"></i> <span>قنوات مباشرة</span>
        </div>
        <div class="main-btn" tabindex="2" onclick="loadCategories('movie')">
            <i class="fas fa-film"></i> <span>أفلام</span>
        </div>
        <div class="main-btn" tabindex="3" onclick="loadCategories('series')">
            <i class="fas fa-video"></i> <span>مسلسلات</span>
        </div>
    </div>

    <div id="list-screen">
        <div class="sidebar" id="sidebar"></div>
        <div class="content-area" id="content-area"></div>
    </div>

<script>
    const CONFIG = {
        host: "http://aseaf1.me:8080",
        user: "292737757579",
        pass: "196384823579"
    };

    let currentType = '';
    let cache = {};

    async function apiRequest(action) {
        const url = `${CONFIG.host}/player_api.php?username=${CONFIG.user}&password=${CONFIG.pass}&action=${action}`;
        const res = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`);
        return await res.json();
    }

    async function loadCategories(type) {
        document.getElementById('loader').style.display = 'flex';
        currentType = type;
        const action = type === 'live' ? 'get_live_categories' : (type === 'movie' ? 'get_vod_categories' : 'get_series_categories');
        
        const data = await apiRequest(action);
        renderSidebar(data);
    }

    function renderSidebar(categories) {
        const sidebar = document.getElementById('sidebar');
        document.getElementById('home-screen').style.display = 'none';
        document.getElementById('list-screen').style.display = 'grid';
        sidebar.innerHTML = '';

        categories.forEach(cat => {
            const div = document.createElement('div');
            div.className = 'category-item';
            div.tabIndex = 0;
            div.innerText = cat.category_name;
            div.onclick = () => loadItems(cat.category_id);
            sidebar.appendChild(div);
        });
        document.getElementById('loader').style.display = 'none';
        sidebar.firstChild.focus();
    }

    async function loadItems(catId) {
        document.getElementById('loader').style.display = 'flex';
        const action = currentType === 'live' ? 'get_live_streams' : (currentType === 'movie' ? 'get_vod_streams' : 'get_series');
        const data = await apiRequest(`${action}&category_id=${catId}`);
        renderContent(data);
    }

    function renderContent(items) {
        const container = document.getElementById('content-area');
        container.innerHTML = '';

        items.slice(0, 200).forEach(item => {
            const div = document.createElement('div');
            div.className = 'poster-card';
            div.tabIndex = 0;
            const img = item.stream_icon || item.cover || 'https://raw.githubusercontent.com/azooz152/family-app/main/home.png';
            
            div.innerHTML = `<img src="${img}" loading="lazy"><div class="title">${item.name}</div>`;

            div.onclick = () => {
                const id = item.stream_id || item.series_id;
                const ext = item.container_extension || 'ts';
                const streamUrl = `${CONFIG.host}/${currentType === 'live' ? 'live' : 'movie'}/${CONFIG.user}/${CONFIG.pass}/${id}.${ext}`;
                if (window.AppInventor) window.AppInventor.setWebViewString(streamUrl);
            };
            container.appendChild(div);
        });
        document.getElementById('loader').style.display = 'none';
        container.firstChild.focus();
    }

    // زر الرجوع بالريموت
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Backspace') {
            if (document.getElementById('list-screen').style.display === 'grid') {
                location.reload();
            }
        }
    });
</script>
</body>
</html>
